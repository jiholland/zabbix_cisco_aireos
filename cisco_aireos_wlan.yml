zabbix_export:
  version: '6.0'
  date: '2022-12-09T18:02:53Z'
  groups:
    -
      uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
  templates:
    -
      uuid: 0f84ac7097544ce99cf364473c2a18e7
      template: AIREOS-WLAN-STATUS-SNMP
      name: AIREOS-WLAN-STATUS-SNMP
      description: |
        Template for monitoring the WLAN status.
        
        Tested on Cisco AireOS WLC 5520
        
        --JÃ¸rn Ivar Holland
      groups:
        -
          name: Templates/Modules
      discovery_rules:
        -
          uuid: cba05e93dbc1469bb360b4763c8f9a83
          name: 'WLAN Status Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SENSOR_INFO},1.3.6.1.4.1.14179.2.1.1.1.2]'
          key: bsnDot11EssSsid
          delay: 6h
          description: |
            bsnDot11EssSsid OBJECT-TYPE
            SYNTAX DisplayString (SIZE (1..32))
            MAX-ACCESS read-create
            STATUS current
            DESCRIPTION
            "SSID assigned to ESS(WLAN)"
          item_prototypes:
            -
              uuid: 8a6a8d33e8b646f8a1f9fdb912aeb482
              name: 'WLAN {#SENSOR_INFO}: Operation State'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14179.2.1.1.1.6.{#SNMPINDEX}'
              key: 'bsnDot11EssAdminStatus[{#SNMPINDEX}]'
              delay: 10m
              history: 30d
              description: |
                Administrative Status of ESS(WLAN). By disabling an
                ESS the corresponding SSID is no longer broadcasted
                in AP beacons.
              valuemap:
                name: bsnDot11EssAdminStatus
              tags:
                -
                  tag: component
                  value: wlan
              trigger_prototypes:
                -
                  uuid: 5420a52c97f34df7b0382dca081bd39e
                  expression: 'last(/AIREOS-WLAN-STATUS-SNMP/bsnDot11EssAdminStatus[{#SNMPINDEX}])=0'
                  name: 'SSID {#SENSOR_INFO} is disabled'
                  priority: WARNING
                  description: 'SSID {#SENSOR_INFO} has admin status disabled.'
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: availability
            -
              uuid: 99f1f41b10ec45729d208f6d3ee06f05
              name: 'WLAN {#SENSOR_INFO}: Interface Name'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14179.2.1.1.1.42.{#SNMPINDEX}'
              key: 'bsnDot11EssInterfaceName[{#SNMPINDEX}]'
              delay: 10m
              history: 30d
              trends: '0'
              value_type: TEXT
              description: 'Name of the interface used by this WLAN. By default it is set to be the management interface.'
              tags:
                -
                  tag: component
                  value: wlan
            -
              uuid: bd4074e0da384a8289108ec9b0e2653e
              name: 'WLAN {#SENSOR_INFO}: Number of clients'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14179.2.1.1.1.38.{#SNMPINDEX}'
              key: 'bsnDot11EssNumberOfMobileStations[{#SNMPINDEX}]'
              delay: 10m
              history: 30d
              units: clients
              description: 'No of Mobile Stations currently associated with the WLAN.'
              tags:
                -
                  tag: component
                  value: wlan
              trigger_prototypes:
                -
                  uuid: 0a8c3376738942759bff3ba89a4364a8
                  expression: '(last(/AIREOS-WLAN-STATUS-SNMP/bsnDot11EssNumberOfMobileStations[{#SNMPINDEX}],#2) / last(/AIREOS-WLAN-STATUS-SNMP/bsnDot11EssNumberOfMobileStations[{#SNMPINDEX}]))*100 < 5'
                  name: 'SSID {#SENSOR_INFO}: Number of clients was suddenly reduced by 95%'
                  priority: INFO
                  description: 'The number of clients connected to SSID {$SENSOR_INFO} was reduced by over 95% between two SNMP polls.'
                  manual_close: 'YES'
                  tags:
                    -
                      tag: scope
                      value: availability
      valuemaps:
        -
          uuid: 550921e86f0a434591f8b364c3e3049d
          name: bsnDot11EssAdminStatus
          mappings:
            -
              value: '0'
              newvalue: disable
            -
              value: '1'
              newvalue: enable
